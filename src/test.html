<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Facebook-like Chatbox (Bootstrap)</title>
  <!-- Bootstrap 5 CDN -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    /* Giao diện chính */
    body { background: #f0f2f5; }
    .chat-app { max-width: 1100px; margin: 30px auto; }

    /* Sidebar (danh sách cuộc trò chuyện) */
    .sidebar { height: 75vh; overflow-y: auto; }
    .chat-item { cursor: pointer; padding: 10px; border-radius: 12px; }
    .chat-item:hover { background: rgba(0,0,0,0.03); }

    /* Khu vực cuộc trò chuyện */
    .chat-window { height: 75vh; display: flex; flex-direction: column; border-radius: 12px; overflow: hidden; background: #fff; box-shadow: 0 3px 10px rgba(0,0,0,0.08);}
    .chat-header { padding: 12px 16px; border-bottom: 1px solid #eee; display:flex; align-items:center; gap:12px; }

    /* Bubbles */
    .messages { flex: 1; overflow-y: auto; padding: 16px; }
    .msg { max-width: 70%; padding: 10px 14px; border-radius: 18px; margin-bottom: 10px; display: inline-block; }
    .msg.me { background: #1877f2; color: #fff; border-bottom-right-radius: 4px; }
    .msg.other { background: #e4e6eb; color: #050505; border-bottom-left-radius: 4px; }

    .msg-row { display:flex; gap:8px; align-items:flex-end; }
    .msg-row.me { justify-content: flex-end; }
    .msg-row.other { justify-content: flex-start; }

    .avatar-sm { width:40px; height:40px; border-radius:50%; object-fit:cover; }
    .chat-input { border-top: 1px solid #eee; padding: 10px; }
    .input-area { display:flex; gap:8px; align-items:center; }

    /* Mobile tweaks */
    @media (max-width: 767px) {
      .sidebar { display: none; }
      .chat-app { padding: 12px; }
    }
  </style>
</head>
<body>

<div class="container chat-app">
  <div class="row g-3">
    <!-- Sidebar danh sách bạn bè/cuộc trò chuyện -->
    <div class="col-12 col-md-4">
      <div class="card sidebar p-2">
        <div class="d-flex align-items-center mb-2">
          <input class="form-control form-control-sm me-2" id="search" placeholder="Tìm kiếm" />
          <button class="btn btn-sm btn-primary"><i class="fa fa-plus"></i></button>
        </div>

        <!-- List -->
        <div id="chatList">
          <!-- Mỗi item là .chat-item -->
          <div class="chat-item d-flex align-items-center" data-name="Nguyễn An" data-avatar="https://i.pravatar.cc/100?img=12">
            <img src="https://i.pravatar.cc/100?img=12" class="avatar-sm me-2" alt="avatar">
            <div class="flex-grow-1">
              <div class="fw-semibold">Nguyễn An</div>
              <div class="text-muted small">Chào! Hôm nay ổn chứ?</div>
            </div>
            <div class="text-muted small">12:04</div>
          </div>

          <div class="chat-item d-flex align-items-center" data-name="Linh Trần" data-avatar="https://i.pravatar.cc/100?img=5">
            <img src="https://i.pravatar.cc/100?img=5" class="avatar-sm me-2" alt="avatar">
            <div class="flex-grow-1">
              <div class="fw-semibold">Linh Trần</div>
              <div class="text-muted small">Đã gửi ảnh</div>
            </div>
            <div class="text-muted small">Hôm qua</div>
          </div>

          <div class="chat-item d-flex align-items-center" data-name="Team Dev" data-avatar="https://i.pravatar.cc/100?img=20">
            <img src="https://i.pravatar.cc/100?img=20" class="avatar-sm me-2" alt="avatar">
            <div class="flex-grow-1">
              <div class="fw-semibold">Team Dev</div>
              <div class="text-muted small">3 thành viên online</div>
            </div>
            <div class="text-muted small">2 ngày</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Khu vực chat -->
    <div class="col-12 col-md-8">
      <div class="chat-window">
        <!-- Header -->
        <div class="chat-header">
          <img id="currAvatar" src="https://i.pravatar.cc/100?img=12" class="avatar-sm" alt="avatar">
          <div>
            <div id="currName" class="fw-bold">Nguyễn An</div>
            <div id="currStatus" class="text-muted small">Hoạt động gần đây</div>
          </div>
          <div class="ms-auto d-flex gap-2">
            <button class="btn btn-sm" title="Video"><i class="fa fa-video"></i></button>
            <button class="btn btn-sm" title="Call"><i class="fa fa-phone"></i></button>
            <button class="btn btn-sm" title="Info"><i class="fa fa-info-circle"></i></button>
          </div>
        </div>

        <!-- Tin nhắn -->
        <div id="messages" class="messages">
          <!-- sample messages -->
          <div class="msg-row other">
            <img src="https://i.pravatar.cc/100?img=12" class="avatar-sm" alt="avatar">
            <div class="msg other">Chào bạn! Hôm nay có cần giúp gì không?</div>
          </div>

          <div class="msg-row me">
            <div class="msg me">Mình đang làm thử giao diện chat, nhìn giống Facebook không?</div>
          </div>

          <div class="msg-row other">
            <img src="https://i.pravatar.cc/100?img=12" class="avatar-sm" alt="avatar">
            <div class="msg other">Rất ổn! Thêm emoji nữa là tuyệt.</div>
          </div>
        </div>

        <!-- Input -->
        <div class="chat-input">
          <div class="input-area">
            <button id="btnEmoji" class="btn btn-light" title="Emoji"><i class="fa fa-face-smile"></i></button>
            <input id="messageInput" type="text" class="form-control" placeholder="Nhập tin nhắn... (Enter để gửi)">
            <button id="btnAttach" class="btn btn-light" title="Đính kèm"><i class="fa fa-paperclip"></i></button>
            <button id="btnSend" class="btn btn-primary">Gửi</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
  // JS đơn giản để chuyển cuộc trò chuyện khi click vào item và gửi tin nhắn
  const chatList = document.getElementById('chatList');
  const currName = document.getElementById('currName');
  const currAvatar = document.getElementById('currAvatar');
  const messages = document.getElementById('messages');
  const messageInput = document.getElementById('messageInput');
  const btnSend = document.getElementById('btnSend');

  // Mở cuộc trò chuyện mặc định
  function scrollBottom(){ messages.scrollTop = messages.scrollHeight; }
  window.addEventListener('load', scrollBottom);

  chatList.addEventListener('click', (e) => {
    const item = e.target.closest('.chat-item');
    if(!item) return;
    const name = item.dataset.name;
    const avatar = item.dataset.avatar;
    currName.textContent = name;
    currAvatar.src = avatar;

    // Xóa message cũ và thêm 1 message chào mừng (demo)
    messages.innerHTML = '';
    const welcome = document.createElement('div');
    welcome.className = 'msg-row other';
    welcome.innerHTML = `<img src="${avatar}" class="avatar-sm" alt="avatar"><div class="msg other">Chào ${name}! Đây là khung chat demo.</div>`;
    messages.appendChild(welcome);
    scrollBottom();
  });

  function appendMessage(text, who='me'){
    const row = document.createElement('div');
    row.className = 'msg-row ' + (who === 'me' ? 'me' : 'other');

    if(who === 'other'){
      const img = document.createElement('img'); img.src = currAvatar.src; img.className = 'avatar-sm'; img.alt = 'avatar';
      row.appendChild(img);
      const bubble = document.createElement('div'); bubble.className = 'msg other'; bubble.textContent = text;
      row.appendChild(bubble);
    } else {
      const bubble = document.createElement('div'); bubble.className = 'msg me'; bubble.textContent = text;
      row.appendChild(bubble);
    }

    messages.appendChild(row);
    scrollBottom();
  }

  btnSend.addEventListener('click', () => {
    const txt = messageInput.value.trim();
    if(!txt) re
